@page
@model Gestion_Restaurant.Pages.Commandes.CreateModel

@{
    ViewData["Title"] = "Create";
}

<h1>Create</h1>

<h4>Commande</h4>
<hr />
<form method="post">
<div class="row">
        <div class="col-md-4">
            <input asp-for="Commande.CommandeServiPar" type="hidden" />
            <input asp-for="Commande.CommandePreparerPar" type="hidden" />
            <input asp-for="Commande.CommandeProduits" type="hidden" />
            <input asp-for="Commande.CommandeTables" type="hidden" />

            <div asp-validation-summary="ModelOnly" class="text-danger"></div>

            <div class="form-group d-none">
                <label asp-for="Commande.Statut" class="control-label"></label>
                <select asp-for="Commande.Statut" class="form-control" type="hidden">
                    <option value="En préparation">En préparation</option>
                </select>
            </div>
            <div class="form-group">
                <label class="control-label">Barmen</label>
                <select asp-for="BarmenIds" class="form-control" asp-items="ViewBag.BarmanId">
                    @if (!Enumerable.Any(ViewBag.BarmanId))
                    {
                        <option value="" disabled>Aucun barman disponible</option>
                    }
                </select>
            </div>
            <div class="form-group">
                <label class="control-label">Serveurs</label>
                <select asp-for="ServeursIds" class="form-control" asp-items="ViewBag.ServeurId">
                    @if (!Enumerable.Any(ViewBag.ServeurId))
                    {
                        <option value="" disabled>Aucun serveur disponible</option>
                    }
                </select>
            </div>
            <div class="form-group">
                <label class="control-label">Table</label>
                <select asp-for="TablesIds" class="form-control" asp-items="ViewBag.TableId">
                    @if (!Enumerable.Any(ViewBag.TableId))
                    {
                        <option value="" disabled>Aucune table disponible</option>
                    }
                </select>
            </div>
            
            <div class="form-group mt-3">
                <input type="submit" value="Create" class="btn btn-primary" />
                <a asp-page="./Index" class="btn btn-secondary">Retour</a>
            </div>
        </div>
        <div class="col-md-4">
            <div class="form-group" id="produits">
                <label class="control-label">Produit(s)</label>
                <select id="produit" name="produits" class="form-control" asp-items="ViewBag.ProduitId"></select>
            </div>
        </div>
        <div class="col-md-3 mt-2 ps-0" id="buttonsProduit">
            <div class="mt-3">
                <a class="btn btn-primary" id="addProduit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                    </svg>
                </a>
                <div class="mt-2 d-none" id="removeProduit">
                    <a class="btn btn-danger">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-dash" viewBox="0 0 16 16">
                            <path d="M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z" />
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </div>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        var compteur = 0
        $('#addProduit').click(addProduit)
        

        function addProduit(){
            compteur = compteur + 1
            $('#produit').clone().appendTo("#produits").addClass('mt-2').attr('id', 'produits_' + compteur)
            $('#removeProduit').clone().appendTo("#buttonsProduit").removeClass('d-none').addClass('produits_' + compteur).click(removeProduit)
        }
        function removeProduit(){
            $('#'+$(this).attr('class').split(' ')[1]).remove()
            $(this).remove()
        }
    </script>
}
